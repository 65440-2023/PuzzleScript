<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <title>Puzzle Script</title>
<link rel=stylesheet href="docs.css">
<link rel="stylesheet" href="codemirror.css">
<link rel="stylesheet" href="midnight.css">
<link rel="stylesheet" href="console.css">
<link rel="stylesheet" href="gamecanvas.css">
<link rel="stylesheet" href="soundbar.css">
<link rel="stylesheet" href="layout.css">
<link rel="stylesheet" href="toolbar.css">

</head>
<body>
<div class="leftpanel">

<form id="form1" name="form1"  action="javascript:void(0);"><textarea id="code" name="code" rows="20" cols="20">
//<![CDATA[
========
OBJECTS
========

(optional section)


Background  (special, automatically placed in its own layer)
LIGHTGREEN GREEN
.....
0....
...0.
.....     
.0...

Target  (Name)     
YELLOW (Color)
..... (Sprite)
..0..
.000.
..0..
.....     

Player    (Required by game)
PINK     
..0..
00000
..0..
.000.
.0.0.

Wall     
BROWN DARKBROWN     
000.0
.....
0.000
.....
000.0

Crate
RED
00000
0...0
0...0
0...0
00000


=======
SOUNDS
=======

(
  Entityname <MOVE|ACTION|CREATE|DESTROY>
  START
  FINISH
  MESSAGE
)

Crate MOVE 3018293 
START 3124523     
FINISH 4123141
MESSAGE 1312424     

================
COLLISIONLAYERS
================

(Objects on same layer cannot overlap)
Background
Target     
Player, Wall, Crate

=======
LEGEND
=======

(can use lots of symbols, but not directions ( ^v<> ) or letters otherwise in use, nor brackets, nor =
if the new key has more than 1 symbol ("Fallable", say) it can be referred to by either its whole name, or its first symbol

there have to be spaces around the =

can't mix ands and ors
 )

. = Background
# = Wall
P = Player
C = Crate 
* = Crate
O = target
@ = Crate and Target	(shorthand for a square with both a crate and a target)
K = Crate or Target or Player
L = Crate and Target     
M = Crate and Wall

(can use "or" to match one of several entities, useful for defining rule-based
behaviour in terms of properties of objects rather than the objects directly

you cannot use these ones in the level section, because they do not
refer to any particular set of objects that can be placed. Here's an example:

Fallable = Crate or Player 

)

======
RULES     
======     

(rules are applied in order, as many times as possible each before going to the next - this loops until nothing further is changed)

(player can push single block)
[ P > | C ] -> [ P > | C > ]     

(Sokoban doesn't have an action button, but here's an example of one:
If you press action, you push neighbouring blocks away without moving yourself
[ P * | C ] -> [ P * | C > ]
)

(

can do remote checking, to see if two things coexist *at all with

[ A ] [ B ] -> [ C ] [ D ]

useful for remote switches, inventory (have inventory slots as tiles on the top left of the screen, or whatever)

should i allow different rules matching in different directions?
UP [ A ] DOWN [ B ] ->

optimization : if rule of length one, and no directions matched, don't need to make duplicates
 - can probably just do a sweep and remove duplicate rules
)

(the push arrow only applies to the object to its left (so targets and floors don't get pushed, in this case))

(directions are ^v<> - you can use UP DOWN LEFT RIGHT instead if you really want
if you want to specify that something *not* have a force applied to it, use .
[ A. ] -> [A>]
 )

(Direction-specific oness can be prefaced by any combination of 
UP DOWN LEFT RIGHT HORIZONTAL (=LEFT RIGHT) VERTICAL (=UP DOWN)
for instance, gravity might be

DOWN [ F ] -> [ F> ] ( rules only get applied if they don't already match the target state )
there's also the keyword DIAGONALS (= UPRIGHT, DOWNLEFT, RIGHTUP, &c. - there's no arrow-based shorthand equivalent for these) - these need to be explicitly specified, though, if you don't include directions it's assumed ORTHO ( = UP DOWN LEFT RIGHT) 
)


(after all the available rules are applied, actions ( * ) are discarded, and movements are applied, where possible.  Movements are applied until no more movements can be applied without causing collisions)

==============
WINCONDITIONS
==============

(
One or more of the following forms:
  All X on Y
  Some X on Y  (you can say "Any" if you like instead of "Some", they're identical)
  No X on Y
  No X (shorthand for No X on Background, ditto for the others)

  if there are multiple conditions here, they all must be satisfied
)

All Target on Crate     

=======     
LEVELS
=======

MESSAGE Welcome to the game, I hope you have a good time playing.

(level 1)

#########
#.....@.#     
#.P.*.O.#
#.......#
#########

MESSAGE Woah, that was tough, eh?!

(level 2)

#########
#.....@.#
#.P.*.O.#
#.......#
#########

(level 3, this is a tough one!)

#########
#.....@.#
#.P.*.O.#     
#.......#
#########

MESSAGE Thank you for playing the game. 
//]]>    
</textarea></form><!---->
</div>
<div class="righttophalf">
	<div class="uppertoolbar">
	&nbsp;&nbsp;&nbsp;<h2>PuzzleScript Editor</h2> - <a href="javascript:runClick()">RUN</a> - <a href="js:run2()">REBUILD</a> - <a href="js:whatever()">EXPORT</a> - <a href="js:whatever()">LINK</a> &nbsp;&nbsp;
	</div>
	<div class="upperarea">
	
<canvas 
    id="gameCanvas" 
    onmousemove="mouseMove(event)" 
    onmouseout="mouseOut()"
    onkeydown="keyDown()"
></canvas>

	</div>
</div>
<div class="rightbottomhalf">
	<div class="lowertoolbar">
<span id="soundbar">
	&nbsp;<span id="soundbutton"><a onclick="clearConsole();"  title="clears the console" href="javascript:void(0);"><img src="icons/clearConsole.gif" alt="clear console contents"></a></span>
	&nbsp;&nbsp;&nbsp;
	<span id="soundbutton"><a onclick="newSound(0);"  title="collect item sound" href="javascript:void(0);" alt="collect item sound"><img src="icons/audio1.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(7);" title="push sounds" href="javascript:void(0);" alt="push sounds"><img src="icons/audio2.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(2);" title="explosion sound" href="javascript:void(0);" alt="explosion sound"><img src="icons/audio3.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(3);" title="powerup sound" href="javascript:void(0);" alt="powerup sound"><img src="icons/audio4.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(9);" title="bird tweet sound" href="javascript:void(0);" alt="bird tweet sound"><img src="icons/audio5.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(4);" title="hurt sound" href="javascript:void(0);" alt="hurt sound"><img src="icons/audio6.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(5);" title="jump sound" href="javascript:void(0);" alt="jump sound"><img src="icons/audio7.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(1);" title="pew pew sound" href="javascript:void(0);" alt="pew pew pew"><img src="icons/audio8.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(6);" title="selection sound" href="javascript:void(0);" alt="selection sound"><img src="icons/audio9.gif"></a></span>
	<span id="soundbutton"><a onclick="newSound(8);" title="random sound" href="javascript:void(0);" alt="random sound"><img src="icons/audio10.gif"></a></span>
	<form>
	<input type="text" name="sounddat" id="sounddat">
	<input id="clickMe"  name="clickMe" type="button" value="Play seed" onclick="buttonPress();" />
	</form>
</span>	</div>
	<div class="lowerarea" id="lowerarea">
<div id = "consoletextarea" name ="consoletextarea" >
=================================<br>
&nbsp;&nbsp;&nbsp;Puzzle Script Terminal V0.1<br>
=================================<br>
</div>
	</div>
</div>


<script src="rng.js"></script>
<script src="riffwave.js"></script>
<script src="sfxr.js"></script>
<script src="codemirror.js"></script>
<script src="active-line.js"></script>
<script src="colors.js"></script>
<script src="puzzle2.js"></script>
<script src="editor.js"></script>
<script src="fileload.js"></script>
<script src="gamecanvasscript.js"></script>
<script src="soundbar.js"></script>
<script src="toolbar.js"></script>
<script src="console.js"></script>


</body>
</html>